{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":["file:///Users/marcmoller/Documents/GitHub/hhservice/src/app/%28dashboard%29/admin/settings/uploads/route.ts"],"sourcesContent":["import fs from \"fs\";\nimport path from \"path\";\nimport { NextRequest, NextResponse } from \"next/server\";\nimport { IncomingForm, File } from \"formidable\";\nimport { promisify } from \"util\";\nimport { IncomingMessage } from \"http\";\n\n// Konfigurer formidable korrekt\nexport const config = { api: { bodyParser: false } };\n\n// Simpel admin-beskyttelse (Erstat med din auth-løsning)\nasync function isAdmin(req: NextRequest) {\n  const authHeader = req.headers.get(\"Authorization\");\n  return authHeader === \"Bearer SECRET_ADMIN_KEY\"; // Udskift med en rigtig auth-løsning\n}\n\nexport async function POST(req: NextRequest) {\n  if (!(await isAdmin(req))) {\n    return NextResponse.json({ message: \"Ikke autoriseret\" }, { status: 403 });\n  }\n\n  try {\n    const form = new IncomingForm();\n    const uploadDir = path.join(process.cwd(), \"public\"); // Public-mappen\n\n    // Promisify form.parse to handle it asynchronously\n    const parseForm = promisify(form.parse.bind(form));\n\n    const { files } = await parseForm(req as unknown as IncomingMessage);\n\n    if (!files || !(files as any).file) {\n      return NextResponse.json(\n        { message: \"Ingen fil fundet\" },\n        { status: 400 }\n      );\n    }\n\n    const file = Array.isArray((files as any).file)\n      ? (files as any).file[0]\n      : (files as any).file;\n    const oldPath = file.filepath;\n    const fileName = \"larger.png\"; // Overskriver eksisterende fil\n    const newPath = path.join(uploadDir, fileName);\n\n    // Flyt og overskriv filen\n    await fs.promises.rename(oldPath, newPath);\n\n    return NextResponse.json({\n      message: \"Fil uploadet!\",\n      filePath: `/public/${fileName}`,\n    });\n  } catch (error) {\n    return NextResponse.json(\n      { message: \"Fejl ved upload\", error: (error as Error).toString() },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AADA;;;;;;AAKO,MAAM,SAAS;IAAE,KAAK;QAAE,YAAY;IAAM;AAAE;AAEnD,yDAAyD;AACzD,eAAe,QAAQ,GAAgB;IACrC,MAAM,aAAa,IAAI,OAAO,CAAC,GAAG,CAAC;IACnC,OAAO,eAAe,2BAA2B,qCAAqC;AACxF;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI,CAAE,MAAM,QAAQ,MAAO;QACzB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAmB,GAAG;YAAE,QAAQ;QAAI;IAC1E;IAEA,IAAI;QACF,MAAM,OAAO,IAAI,4LAAA,CAAA,eAAY;QAC7B,MAAM,YAAY,iGAAA,CAAA,UAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,WAAW,gBAAgB;QAEtE,mDAAmD;QACnD,MAAM,YAAY,CAAA,GAAA,iGAAA,CAAA,YAAS,AAAD,EAAE,KAAK,KAAK,CAAC,IAAI,CAAC;QAE5C,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,UAAU;QAElC,IAAI,CAAC,SAAS,CAAC,AAAC,MAAc,IAAI,EAAE;YAClC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;YAAmB,GAC9B;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,MAAM,OAAO,CAAC,AAAC,MAAc,IAAI,IAC1C,AAAC,MAAc,IAAI,CAAC,EAAE,GACtB,AAAC,MAAc,IAAI;QACvB,MAAM,UAAU,KAAK,QAAQ;QAC7B,MAAM,WAAW,cAAc,+BAA+B;QAC9D,MAAM,UAAU,iGAAA,CAAA,UAAI,CAAC,IAAI,CAAC,WAAW;QAErC,0BAA0B;QAC1B,MAAM,6FAAA,CAAA,UAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,SAAS;QAElC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,UAAU,CAAC,QAAQ,EAAE,UAAU;QACjC;IACF,EAAE,OAAO,OAAO;QACd,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAmB,OAAO,AAAC,MAAgB,QAAQ;QAAG,GACjE;YAAE,QAAQ;QAAI;IAElB;AACF"}},
    {"offset": {"line": 216, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}