{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["turbopack://[project]/src/middleware.ts"],"sourcesContent":["import { createServerComponentClient } from \"@supabase/auth-helpers-nextjs\";\nimport { NextResponse, type NextRequest } from \"next/server\";\n\nexport async function middleware(request: NextRequest) {\n  const supabase = createServerComponentClient({\n    cookies: () => request.cookies,\n  });\n\n  // Hent bruger fra Supabase session\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    return NextResponse.redirect(new URL(\"/login\", request.url)); // Omdiriger til login, hvis ingen bruger\n  }\n\n  // Slå brugerens rolle op i 'permission'-tabellen\n  const { data: permission, error } = await supabase\n    .from(\"permission\")\n    .select(\"role\")\n    .eq(\"user_id\", user.id)\n    .single();\n\n  if (error || !permission) {\n    console.error(\n      \"Permission lookup failed:\",\n      error?.message || \"No permission found\"\n    );\n    return NextResponse.redirect(new URL(\"/403\", request.url)); // Omdiriger til adgangsnægtet side\n  }\n\n  // Tjek rolle og rute\n  if (\n    request.nextUrl.pathname.startsWith(\"/admin/settings\") &&\n    permission.role === \"editor\"\n  ) {\n    return NextResponse.redirect(new URL(\"/403\", request.url)); // Bloker adgang for 'editor' til /admin/settings\n  }\n\n  return NextResponse.next(); // Tillad adgang, hvis alt er OK\n}\n\nexport const config = {\n  matcher: [\"/admin/:path*\", \"/admin\"],\n};\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;AAEO,eAAe,WAAW,OAAoB;IACnD,MAAM,WAAW,CAAA,GAAA,wKAAA,CAAA,8BAA2B,AAAD,EAAE;QAC3C,SAAS,IAAM,QAAQ,OAAO;IAChC;IAEA,mCAAmC;IACnC,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAE/B,IAAI,CAAC,MAAM;QACT,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG,IAAI,yCAAyC;IACzG;IAEA,iDAAiD;IACjD,MAAM,EAAE,MAAM,UAAU,EAAE,KAAK,EAAE,GAAG,MAAM,SACvC,IAAI,CAAC,cACL,MAAM,CAAC,QACP,EAAE,CAAC,WAAW,KAAK,EAAE,EACrB,MAAM;IAET,IAAI,SAAS,CAAC,YAAY;QACxB,QAAQ,KAAK,CACX,6BACA,OAAO,WAAW;QAEpB,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,QAAQ,QAAQ,GAAG,IAAI,mCAAmC;IACjG;IAEA,qBAAqB;IACrB,IACE,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,sBACpC,WAAW,IAAI,KAAK,UACpB;QACA,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,QAAQ,QAAQ,GAAG,IAAI,iDAAiD;IAC/G;IAEA,OAAO,qLAAA,CAAA,eAAY,CAAC,IAAI,IAAI,gCAAgC;AAC9D;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAiB;KAAS;AACtC"}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}