{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/marcmoller/Documents/GitHub/hhservice/src/utils/supabase/server.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\";\nimport { cookies } from \"next/headers\";\nimport { createClient } from \"@supabase/supabase-js\";\n\nexport async function createServerClientInstance() {\n  const cookieStore = await cookies();\n\n  return createServerClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n    {\n      cookies: {\n        getAll() {\n          return cookieStore.getAll();\n        },\n        setAll(cookiesToSet) {\n          try {\n            cookiesToSet.forEach(({ name, value, options }) =>\n              cookieStore.set(name, value, options)\n            );\n          } catch {\n            // The `setAll` method was called from a Server Component.\n            // This can be ignored if you have middleware refreshing\n            // user sessions.\n          }\n        },\n      },\n    }\n  );\n}\n\nexport async function createAdmin() {\n  return createClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.SUPABASE_SERVICE_ROLE_KEY!,\n    {\n      auth: {\n        autoRefreshToken: false,\n        persistSession: false,\n      },\n    }\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AADA;AAQI;AANJ;;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,CAAA,GAAA,kIAAA,CAAA,UAAO,AAAD;IAEhC,OAAO,CAAA,GAAA,4KAAA,CAAA,qBAAkB,AAAD,sUAGtB;QACE,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;gBAEjC,EAAE,OAAM;gBACN,0DAA0D;gBAC1D,wDAAwD;gBACxD,iBAAiB;gBACnB;YACF;QACF;IACF;AAEJ;AAEO,eAAe;IACpB,OAAO,CAAA,GAAA,0LAAA,CAAA,eAAY,AAAD,gFAEhB,gKAAA,CAAA,UAAO,CAAC,GAAG,CAAC,yBAAyB,EACrC;QACE,MAAM;YACJ,kBAAkB;YAClB,gBAAgB;QAClB;IACF;AAEJ"}},
    {"offset": {"line": 49, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///Users/marcmoller/Documents/GitHub/hhservice/src/lib/store/authStore.ts"],"sourcesContent":["import { create } from \"zustand\";\n\n// Definér typen for brugerens data\ninterface User {\n  id: string;\n  email: string | undefined;\n}\n\n// Definér Zustand state\ninterface AuthState {\n  user: User | null; // Brugerens data\n  role: \"admin\" | \"editor\" | null; // Brugerens rolle\n  setUser: (user: User) => void; // Sæt brugerdata\n  setRole: (role: \"admin\" | \"editor\") => void; // Sæt brugerrolle\n  clearSession: () => void; // Ryd session\n}\n\n// Opret Zustand-store\nexport const useAuthStore = create<AuthState>((set) => ({\n  user: null,\n  role: null,\n  setUser: (user) => set({ user }),\n  setRole: (role) => set({ role }),\n  clearSession: () => set({ user: null, role: null }),\n}));\n"],"names":[],"mappings":";;;AAAA;;AAkBO,MAAM,eAAe,CAAA,GAAA,2IAAA,CAAA,SAAM,AAAD,EAAa,CAAC,MAAQ,CAAC;QACtD,MAAM;QACN,MAAM;QACN,SAAS,CAAC,OAAS,IAAI;gBAAE;YAAK;QAC9B,SAAS,CAAC,OAAS,IAAI;gBAAE;YAAK;QAC9B,cAAc,IAAM,IAAI;gBAAE,MAAM;gBAAM,MAAM;YAAK;IACnD,CAAC"}},
    {"offset": {"line": 77, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 83, "column": 0}, "map": {"version":3,"sources":["file:///Users/marcmoller/Documents/GitHub/hhservice/src/lib/auth/authSessions.ts"],"sourcesContent":["import { createServerClientInstance } from \"@/utils/supabase/server\";\nimport { useAuthStore } from \"../store/authStore\";\n\nexport async function readUserSession() {\n  const supabase = await createServerClientInstance();\n\n  try {\n    // Hent brugerdata fra Supabase session\n    const { data: userResponse, error: userError } =\n      await supabase.auth.getUser();\n\n    if (userError || !userResponse?.user) {\n      console.error(\"User fetch error:\", userError?.message || \"No user found\");\n      return null;\n    }\n\n    // Hent rolle direkte fra brugerens metadata\n    const role = userResponse.user.user_metadata?.role;\n\n    if (!role) {\n      console.error(\"Role not found in metadata\");\n      return null;\n    }\n\n    return {\n      user: userResponse.user,\n      role,\n    };\n  } catch (error) {\n    console.error(\"Unexpected error in readUserSession:\", error);\n    return null;\n  }\n}\n\nexport async function fetchAndSetUserSession() {\n  try {\n    const session = await readUserSession();\n\n    if (session) {\n      useAuthStore.getState().setUser({\n        id: session.user.id,\n        email: session.user.email,\n      });\n      useAuthStore.getState().setRole(session.role as \"admin\" | \"editor\");\n    } else {\n      useAuthStore.getState().clearSession();\n    }\n  } catch (error) {\n    console.error(\"Failed to fetch and set session:\", error);\n    useAuthStore.getState().clearSession();\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,WAAW,MAAM,CAAA,GAAA,qIAAA,CAAA,6BAA0B,AAAD;IAEhD,IAAI;QACF,uCAAuC;QACvC,MAAM,EAAE,MAAM,YAAY,EAAE,OAAO,SAAS,EAAE,GAC5C,MAAM,SAAS,IAAI,CAAC,OAAO;QAE7B,IAAI,aAAa,CAAC,cAAc,MAAM;YACpC,QAAQ,KAAK,CAAC,qBAAqB,WAAW,WAAW;YACzD,OAAO;QACT;QAEA,4CAA4C;QAC5C,MAAM,OAAO,aAAa,IAAI,CAAC,aAAa,EAAE;QAE9C,IAAI,CAAC,MAAM;YACT,QAAQ,KAAK,CAAC;YACd,OAAO;QACT;QAEA,OAAO;YACL,MAAM,aAAa,IAAI;YACvB;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wCAAwC;QACtD,OAAO;IACT;AACF;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,UAAU,MAAM;QAEtB,IAAI,SAAS;YACX,mIAAA,CAAA,eAAY,CAAC,QAAQ,GAAG,OAAO,CAAC;gBAC9B,IAAI,QAAQ,IAAI,CAAC,EAAE;gBACnB,OAAO,QAAQ,IAAI,CAAC,KAAK;YAC3B;YACA,mIAAA,CAAA,eAAY,CAAC,QAAQ,GAAG,OAAO,CAAC,QAAQ,IAAI;QAC9C,OAAO;YACL,mIAAA,CAAA,eAAY,CAAC,QAAQ,GAAG,YAAY;QACtC;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,oCAAoC;QAClD,mIAAA,CAAA,eAAY,CAAC,QAAQ,GAAG,YAAY;IACtC;AACF"}},
    {"offset": {"line": 135, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 141, "column": 0}, "map": {"version":3,"sources":["file:///Users/marcmoller/Documents/GitHub/hhservice/src/components/admin/layout/Navbar.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\n\nimport Link from \"next/link\";\nimport { usePathname } from \"next/navigation\";\nimport { FaGear, FaHouse, FaList } from \"react-icons/fa6\";\nimport { useAuthStore } from \"@/lib/store/authStore\";\nimport { readUserSession } from \"@/lib/auth/authSessions\";\n\nconst Navbar = () => {\n  const pathname = usePathname();\n  const [role, setRole] = useState<string | null>(null);\n\n  useEffect(() => {\n    (async () => {\n      const session = await readUserSession();\n      if (session) {\n        setRole(session.role);\n      } else {\n        setRole(null);\n      }\n    })();\n  }, []);\n\n  return (\n    <div className=\"flex flex-col items-center justify-between  bg-base-100 rounded-lg md:fixed sm:h-full md:py-0 md:pr-0\">\n      <div className=\"flex flex-col md:gap-7 h-full \">\n        <div className=\"flex flex-col items-center justify-center h-24 w-full text-xl\">\n          <span className=\"font-bold\">ADMIN</span>\n          <span className=\"text-sm\">HH SERVICE</span>\n        </div>\n        <div className=\"hidden sm:flex\">\n          <ul className=\"menu gap-2 rounded-box w-56\">\n            <li>\n              <Link\n                className={pathname === \"/admin\" ? \"active\" : \"\"}\n                href=\"/admin\"\n              >\n                Overblik\n              </Link>\n            </li>\n            <li>\n              <Link\n                className={pathname === \"/admin/content\" ? \"active\" : \"\"}\n                href=\"/admin/content\"\n              >\n                Indhold\n              </Link>\n            </li>\n            {role === \"admin\" && (\n              <li>\n                <Link\n                  className={pathname === \"/admin/settings\" ? \"active\" : \"\"}\n                  href=\"/admin/settings\"\n                >\n                  Indstillinger\n                </Link>\n              </li>\n            )}\n          </ul>\n        </div>\n        <div className=\"flex flex-col items-center sm:hidden fixed bottom-0 left-1/2 transform -translate-x-1/2 justify-center z-30\">\n          <ul className=\"menu menu-horizontal menu-lg bg-base-200 rounded-box\">\n            <li>\n              <Link\n                href=\"/admin\"\n                className={pathname === \"/admin\" ? \"active\" : \"\"}\n              >\n                <FaHouse size={25} />\n              </Link>\n            </li>\n            <li>\n              <Link\n                href=\"/admin/content\"\n                className={pathname === \"/admin/content\" ? \"active\" : \"\"}\n              >\n                <FaList size={25} />\n              </Link>\n            </li>\n            {role === \"admin\" && (\n              <li>\n                <Link\n                  href=\"/admin/settings\"\n                  className={pathname === \"/admin/settings\" ? \"active\" : \"\"}\n                >\n                  <FaGear size={25} />\n                </Link>\n              </li>\n            )}\n          </ul>\n          <span className=\" text-[9px] flex items-center justify-center p-4\">\n            © Crafted by Marccode\n          </span>\n        </div>\n      </div>\n      <span className=\" text-[9px] hidden sm:flex items-center justify-center p-4\">\n        © Crafted by Marccode\n      </span>\n    </div>\n  );\n};\n\nexport default Navbar;\n"],"names":[],"mappings":";;;;AAEA;AAEA;AACA;AAGA;AAFA;;;AANA;;;;;;AAUA,MAAM,SAAS;;IACb,MAAM,WAAW,CAAA,GAAA,qIAAA,CAAA,cAAW,AAAD;IAC3B,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB;IAEhD,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;4BAAE;YACR;oCAAC;oBACC,MAAM,UAAU,MAAM,CAAA,GAAA,qIAAA,CAAA,kBAAe,AAAD;oBACpC,IAAI,SAAS;wBACX,QAAQ,QAAQ,IAAI;oBACtB,OAAO;wBACL,QAAQ;oBACV;gBACF;aAAC;QACH;2BAAG,EAAE;IAEL,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAK,WAAU;0CAAY;;;;;;0CAC5B,6LAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;kCAE5B,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAG,WAAU;;8CACZ,6LAAC;8CACC,cAAA,6LAAC,+JAAA,CAAA,UAAI;wCACH,WAAW,aAAa,WAAW,WAAW;wCAC9C,MAAK;kDACN;;;;;;;;;;;8CAIH,6LAAC;8CACC,cAAA,6LAAC,+JAAA,CAAA,UAAI;wCACH,WAAW,aAAa,mBAAmB,WAAW;wCACtD,MAAK;kDACN;;;;;;;;;;;gCAIF,SAAS,yBACR,6LAAC;8CACC,cAAA,6LAAC,+JAAA,CAAA,UAAI;wCACH,WAAW,aAAa,oBAAoB,WAAW;wCACvD,MAAK;kDACN;;;;;;;;;;;;;;;;;;;;;;kCAOT,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAG,WAAU;;kDACZ,6LAAC;kDACC,cAAA,6LAAC,+JAAA,CAAA,UAAI;4CACH,MAAK;4CACL,WAAW,aAAa,WAAW,WAAW;sDAE9C,cAAA,6LAAC,kJAAA,CAAA,UAAO;gDAAC,MAAM;;;;;;;;;;;;;;;;kDAGnB,6LAAC;kDACC,cAAA,6LAAC,+JAAA,CAAA,UAAI;4CACH,MAAK;4CACL,WAAW,aAAa,mBAAmB,WAAW;sDAEtD,cAAA,6LAAC,kJAAA,CAAA,SAAM;gDAAC,MAAM;;;;;;;;;;;;;;;;oCAGjB,SAAS,yBACR,6LAAC;kDACC,cAAA,6LAAC,+JAAA,CAAA,UAAI;4CACH,MAAK;4CACL,WAAW,aAAa,oBAAoB,WAAW;sDAEvD,cAAA,6LAAC,kJAAA,CAAA,SAAM;gDAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;0CAKtB,6LAAC;gCAAK,WAAU;0CAAmD;;;;;;;;;;;;;;;;;;0BAKvE,6LAAC;gBAAK,WAAU;0BAA6D;;;;;;;;;;;;AAKnF;GA3FM;;QACa,qIAAA,CAAA,cAAW;;;KADxB;uCA6FS"}},
    {"offset": {"line": 390, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 396, "column": 0}, "map": {"version":3,"sources":["file:///Users/marcmoller/Documents/GitHub/hhservice/src/lib/server/actions.ts"],"sourcesContent":["\"use server\";\n\nimport {\n  createAdmin,\n  createServerClientInstance,\n} from \"@/utils/supabase/server\";\nimport { revalidatePath } from \"next/cache\";\nimport { redirect } from \"next/navigation\";\nimport { useAuthStore } from \"../store/authStore\";\n\n//REGISTER\n\nexport async function createMember(data: {\n  email: string;\n  password: string;\n  role: \"editor\" | \"admin\";\n  name: string;\n}) {\n  const supabase = await createAdmin();\n\n  try {\n    const createResult = await supabase.auth.admin.createUser({\n      email: data.email,\n      password: data.password,\n      email_confirm: true,\n      user_metadata: {\n        role: data.role,\n      },\n    });\n\n    if (createResult.error) {\n      console.error(\"Failed to create user:\", createResult.error.message);\n      throw new Error(\"Failed to create user: \" + createResult.error.message);\n    }\n\n    console.log(\"User created:\", createResult.data.user);\n\n    const memberResult = await supabase\n      .from(\"members\")\n      .insert({ name: data.name, id: createResult.data.user?.id });\n\n    if (memberResult.error) {\n      console.error(\n        \"Failed to insert into members:\",\n        memberResult.error.message\n      );\n      throw new Error(\n        \"Failed to insert into members: \" + memberResult.error.message\n      );\n    }\n\n    console.log(\"Member inserted:\", memberResult.data);\n\n    const permissionsResult = await supabase\n      .from(\"permissions\")\n      .insert({ role: data.role, member_id: createResult.data.user?.id });\n\n    if (permissionsResult.error) {\n      console.error(\n        \"Failed to insert into permissions:\",\n        permissionsResult.error.message\n      );\n      throw new Error(\n        \"Failed to insert into permissions: \" + permissionsResult.error.message\n      );\n    }\n\n    console.log(\"Permissions inserted:\", permissionsResult.data);\n\n    return createResult.data.user;\n  } catch (err) {\n    console.error(\"Unexpected error during member creation:\", err);\n    throw err;\n  }\n}\n\n//LOGOUT\n\nexport async function signOut() {\n  const supabase = await createServerClientInstance();\n\n  await supabase.auth.signOut();\n\n  revalidatePath(\"/\", \"layout\");\n  redirect(\"/login\");\n}\n\n// ADMIN GET ALL USERS\n\nexport async function getAllUsers() {\n  const supabase = await createAdmin();\n\n  const {\n    data: { users },\n    error: fetchError,\n  } = await supabase.auth.admin.listUsers();\n\n  if (fetchError) {\n    throw new Error(\"Failed to fetch users: \" + fetchError.message);\n  }\n\n  return users || [];\n}\n"],"names":[],"mappings":";;;;;;;IAYsB;IAkEA;IAWA"}},
    {"offset": {"line": 406, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 412, "column": 0}, "map": {"version":3,"sources":["file:///Users/marcmoller/Documents/GitHub/hhservice/src/components/admin/layout/Topbar.tsx"],"sourcesContent":["\"use client\";\nimport { signOut } from \"@/lib/server/actions\";\nimport { usePathname } from \"next/navigation\";\nimport React from \"react\";\nimport { FaEllipsis } from \"react-icons/fa6\";\n\ninterface PageTitleMapping {\n  [key: string]: string;\n}\n\nconst Topbar = () => {\n  const pathname = usePathname();\n\n  const pageTitles: PageTitleMapping = {\n    \"/admin\": \"Overblik\",\n    \"/admin/content\": \"Indhold\",\n    \"/admin/settings\": \"Indstillinger\",\n  };\n\n  const currentTitle = pageTitles[pathname] || \"Unknown Page\";\n\n  return (\n    <div className=\"navbar bg-base-100 shadow-sm w-full rounded-md pl-5\">\n      <div className=\"flex-1\">\n        <a className=\"text-lg\">{currentTitle}</a>\n      </div>\n      <div className=\"flex-none\">\n        <div className=\"dropdown dropdown-bottom dropdown-end\">\n          <div tabIndex={0} role=\"button\" className=\"btn btn-ghost m-1\">\n            {\" \"}\n            <FaEllipsis />\n          </div>\n          <ul\n            tabIndex={0}\n            className=\"dropdown-content menu bg-base-100 rounded-box z-[1] w-52 p-2 shadow\"\n          >\n            <li>\n              <button onClick={signOut}>Log ud</button>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Topbar;\n"],"names":[],"mappings":";;;;AACA;AACA;AAEA;;;AAJA;;;;AAUA,MAAM,SAAS;;IACb,MAAM,WAAW,CAAA,GAAA,qIAAA,CAAA,cAAW,AAAD;IAE3B,MAAM,aAA+B;QACnC,UAAU;QACV,kBAAkB;QAClB,mBAAmB;IACrB;IAEA,MAAM,eAAe,UAAU,CAAC,SAAS,IAAI;IAE7C,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAE,WAAU;8BAAW;;;;;;;;;;;0BAE1B,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,UAAU;4BAAG,MAAK;4BAAS,WAAU;;gCACvC;8CACD,6LAAC,kJAAA,CAAA,aAAU;;;;;;;;;;;sCAEb,6LAAC;4BACC,UAAU;4BACV,WAAU;sCAEV,cAAA,6LAAC;0CACC,cAAA,6LAAC;oCAAO,SAAS,kIAAA,CAAA,UAAO;8CAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOxC;GAlCM;;QACa,qIAAA,CAAA,cAAW;;;KADxB;uCAoCS"}},
    {"offset": {"line": 526, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}